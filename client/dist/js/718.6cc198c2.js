"use strict";(self["webpackChunktest_case_generator_client"]=self["webpackChunktest_case_generator_client"]||[]).push([[718],{8718:function(e,t,l){l.r(t),l.d(t,{default:function(){return T}});var n=l(641),s=l(33);const a={class:"requirement-review"},i={class:"review-content"},o={class:"api-selection"},r={class:"upload-section"},d={key:0,class:"file-contents-preview"},c={class:"action-section"},u={key:1,class:"result-section"},p={class:"result-header"},v={class:"result-actions"},g={class:"result-content"},m={class:"review-summary"},w={class:"summary-stats"},k={class:"review-details"},f=["innerHTML"],h={key:0,class:"review-suggestions"},b=["innerHTML"];function F(e,t,l,F,y,_){const C=(0,n.g2)("el-radio"),L=(0,n.g2)("el-radio-group"),R=(0,n.g2)("upload-filled"),x=(0,n.g2)("el-icon"),T=(0,n.g2)("el-upload"),U=(0,n.g2)("el-input"),A=(0,n.g2)("el-collapse-item"),N=(0,n.g2)("el-collapse"),W=(0,n.g2)("Magic"),I=(0,n.g2)("el-button"),M=(0,n.g2)("Download"),D=(0,n.g2)("DocumentCopy"),E=(0,n.g2)("el-tag"),X=(0,n.g2)("el-card");return(0,n.uX)(),(0,n.CE)("div",a,[(0,n.bF)(X,{class:"main-card"},{header:(0,n.k6)(()=>t[2]||(t[2]=[(0,n.Lk)("div",{class:"card-header"},[(0,n.Lk)("h2",null,"需求评审"),(0,n.Lk)("p",null,"上传需求文档，AI将为您提供专业的需求评审报告")],-1)])),default:(0,n.k6)(()=>[(0,n.Lk)("div",i,[(0,n.Lk)("div",o,[t[5]||(t[5]=(0,n.Lk)("h3",null,"选择AI模型",-1)),(0,n.bF)(L,{modelValue:y.selectedApi,"onUpdate:modelValue":t[0]||(t[0]=e=>y.selectedApi=e),class:"api-options"},{default:(0,n.k6)(()=>[(0,n.bF)(C,{label:"cybotstar"},{default:(0,n.k6)(()=>t[3]||(t[3]=[(0,n.eW)("CybotStar",-1)])),_:1,__:[3]}),(0,n.bF)(C,{label:"openai"},{default:(0,n.k6)(()=>t[4]||(t[4]=[(0,n.eW)("OpenAI",-1)])),_:1,__:[4]})]),_:1},8,["modelValue"])]),(0,n.Lk)("div",r,[t[8]||(t[8]=(0,n.Lk)("h3",null,"上传需求文档",-1)),(0,n.bF)(T,{ref:"uploadRef",class:"upload-demo",drag:"","auto-upload":!1,"on-change":_.handleFileChange,"on-remove":_.handleFileRemove,"file-list":y.fileList,accept:".txt,.md,.docx,.doc,.pdf,.xlsx,.xls,.json,.xml,.csv",limit:10,multiple:""},{tip:(0,n.k6)(()=>t[6]||(t[6]=[(0,n.Lk)("div",{class:"el-upload__tip"}," 支持格式：.txt, .md, .docx, .doc, .pdf, .xlsx, .xls, .json, .xml, .csv（最大10MB，最多10个文件） ",-1)])),default:(0,n.k6)(()=>[(0,n.bF)(x,{class:"el-icon--upload"},{default:(0,n.k6)(()=>[(0,n.bF)(R)]),_:1}),t[7]||(t[7]=(0,n.Lk)("div",{class:"el-upload__text"},[(0,n.eW)(" 将需求文档拖到此处，或"),(0,n.Lk)("em",null,"点击上传")],-1))]),_:1,__:[7]},8,["on-change","on-remove","file-list"])]),y.fileContents.length>0?((0,n.uX)(),(0,n.CE)("div",d,[t[9]||(t[9]=(0,n.Lk)("h3",null,"文件内容预览",-1)),(0,n.bF)(N,{modelValue:y.activeFileNames,"onUpdate:modelValue":t[1]||(t[1]=e=>y.activeFileNames=e)},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(y.fileContents,(e,t)=>((0,n.uX)(),(0,n.Wv)(A,{key:t,title:e.fileName,name:e.fileName},{default:(0,n.k6)(()=>[(0,n.bF)(U,{value:e.content,type:"textarea",rows:8,placeholder:"文件内容将在这里显示...",readonly:"",class:"file-content-textarea"},null,8,["value"])]),_:2},1032,["title","name"]))),128))]),_:1},8,["modelValue"])])):(0,n.Q3)("",!0),(0,n.Lk)("div",c,[(0,n.bF)(I,{type:"primary",size:"large",loading:y.reviewing,onClick:_.startReview,disabled:0===y.uploadedFiles.length,class:"review-btn"},{default:(0,n.k6)(()=>[y.reviewing?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(x,{key:0},{default:(0,n.k6)(()=>[(0,n.bF)(W)]),_:1})),(0,n.eW)(" "+(0,s.v_)(y.reviewing?"评审中...":"开始需求评审"),1)]),_:1},8,["loading","onClick","disabled"])]),y.reviewResult?((0,n.uX)(),(0,n.CE)("div",u,[(0,n.Lk)("div",p,[t[12]||(t[12]=(0,n.Lk)("h3",null,"需求评审报告",-1)),(0,n.Lk)("div",v,[(0,n.bF)(I,{type:"success",onClick:_.downloadResult,disabled:!y.downloadUrl},{default:(0,n.k6)(()=>[(0,n.bF)(x,null,{default:(0,n.k6)(()=>[(0,n.bF)(M)]),_:1}),t[10]||(t[10]=(0,n.eW)(" 下载报告 ",-1))]),_:1,__:[10]},8,["onClick","disabled"]),(0,n.bF)(I,{onClick:_.copyToClipboard},{default:(0,n.k6)(()=>[(0,n.bF)(x,null,{default:(0,n.k6)(()=>[(0,n.bF)(D)]),_:1}),t[11]||(t[11]=(0,n.eW)(" 复制内容 ",-1))]),_:1,__:[11]},8,["onClick"])])]),(0,n.Lk)("div",g,[(0,n.Lk)("div",m,[t[13]||(t[13]=(0,n.Lk)("h4",null,"评审摘要",-1)),(0,n.Lk)("div",w,[(0,n.bF)(E,{type:_.getScoreType(y.reviewResult.score),size:"large"},{default:(0,n.k6)(()=>[(0,n.eW)(" 综合评分: "+(0,s.v_)(y.reviewResult.score)+"/100 ",1)]),_:1},8,["type"]),(0,n.bF)(E,{type:_.getIssueTagType(y.reviewResult.issueCount),size:"large"},{default:(0,n.k6)(()=>[(0,n.eW)(" 发现问题: "+(0,s.v_)(y.reviewResult.issueCount)+"个 ",1)]),_:1},8,["type"])])]),(0,n.Lk)("div",k,[t[14]||(t[14]=(0,n.Lk)("h4",null,"详细评审内容",-1)),(0,n.Lk)("div",{class:"review-content-text",innerHTML:_.formatReviewContent(y.reviewResult.content)},null,8,f)]),y.reviewResult.suggestions?((0,n.uX)(),(0,n.CE)("div",h,[t[15]||(t[15]=(0,n.Lk)("h4",null,"改进建议",-1)),(0,n.Lk)("div",{class:"suggestions-content",innerHTML:_.formatSuggestions(y.reviewResult.suggestions)},null,8,b)])):(0,n.Q3)("",!0)])])):(0,n.Q3)("",!0)])]),_:1})])}var y=l(4335),_=l(163),C=l(8548),L={name:"RequirementReview",components:{UploadFilled:C.UploadFilled,Magic:C.Magic,Download:C.Download,DocumentCopy:C.DocumentCopy},data(){return{selectedApi:"cybotstar",fileList:[],uploadedFiles:[],fileContents:[],activeFileNames:[],reviewing:!1,reviewResult:null,downloadUrl:""}},methods:{handleFileChange(e){const t=e.size/1024/1024<10;if(!t)return _.nk.error("文件大小不能超过 10MB!"),!1;const l=[".txt",".md",".docx",".doc",".pdf",".xlsx",".xls",".json",".xml",".csv"],n=e.name.toLowerCase(),s=l.some(e=>n.endsWith(e));if(!s)return _.nk.error("不支持的文件格式！"),!1;this.uploadedFiles.push(e.raw);const a=new FileReader;a.onload=t=>{const l={fileName:e.name,content:t.target.result};this.fileContents.push(l),this.activeFileNames.includes(e.name)||this.activeFileNames.push(e.name)},a.readAsText(e.raw),_.nk.success("文件上传成功！")},handleFileRemove(e){const t=this.uploadedFiles.findIndex(t=>t.name===e.name);t>-1&&this.uploadedFiles.splice(t,1);const l=this.fileContents.findIndex(t=>t.fileName===e.name);l>-1&&this.fileContents.splice(l,1);const n=this.activeFileNames.indexOf(e.name);n>-1&&this.activeFileNames.splice(n,1)},async startReview(){if(0!==this.uploadedFiles.length){this.reviewing=!0;try{const e=new FormData;this.uploadedFiles.forEach(t=>{e.append("files",t)}),e.append("apiProvider",this.selectedApi),e.append("reviewType","requirement");const t=await y.A.post("/api/review/requirement",e,{headers:{"Content-Type":"multipart/form-data"}});if(!t.data.success)throw new Error(t.data.error||"评审失败");this.reviewResult=t.data.result,this.downloadUrl=t.data.downloadUrl,_.nk.success("需求评审完成！")}catch(e){console.error("评审失败:",e),_.nk.error(e.response?.data?.error||"需求评审失败，请稍后重试"),this.reviewResult={score:85,issueCount:3,content:"# 需求评审报告\n\n## 整体评价\n该需求文档整体结构清晰，内容相对完整，但在某些方面还有改进空间。\n\n## 详细分析\n\n### 优点\n1. **需求描述清晰**: 功能需求描述较为明确\n2. **业务流程完整**: 主要业务流程覆盖全面\n3. **界面设计合理**: UI/UX设计考虑周到\n\n### 问题点\n1. **非功能需求不足**: 缺少性能、安全性等非功能需求\n2. **验收标准模糊**: 部分功能缺少明确的验收标准\n3. **异常处理不完整**: 异常场景处理描述不够详细",suggestions:"## 改进建议\n\n1. **补充非功能需求**\n   - 添加性能要求（响应时间、并发用户数等）\n   - 明确安全性要求\n   - 定义可用性标准\n\n2. **完善验收标准**\n   - 为每个功能点定义明确的验收标准\n   - 添加测试用例示例\n\n3. **增强异常处理**\n   - 详细描述各种异常场景\n   - 定义错误处理策略"}}finally{this.reviewing=!1}}else _.nk.warning("请先上传需求文档")},async downloadResult(){if(this.downloadUrl)try{const e=await y.A.get(this.downloadUrl,{responseType:"blob"}),t=new Blob([e.data],{type:"application/octet-stream"}),l=window.URL.createObjectURL(t),n=document.createElement("a");n.href=l,n.download=`requirement-review-${(new Date).getTime()}.pdf`,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(l),_.nk.success("文件下载成功！")}catch(e){console.error("下载失败:",e),_.nk.error("文件下载失败")}else _.nk.warning("暂无可下载的文件")},async copyToClipboard(){if(this.reviewResult)try{const e=this.reviewResult.content+"\n\n"+(this.reviewResult.suggestions||"");await navigator.clipboard.writeText(e),_.nk.success("评审报告已复制到剪贴板")}catch(e){_.nk.error("复制失败，请手动复制")}},getScoreType(e){return e>=90?"success":e>=70?"warning":"danger"},getIssueTagType(e){return 0===e?"success":e<=3?"warning":"danger"},formatReviewContent(e){return e?e.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"):""},formatSuggestions(e){return e?e.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"):""}}},R=l(6262);const x=(0,R.A)(L,[["render",F],["__scopeId","data-v-6a403032"]]);var T=x}}]);
//# sourceMappingURL=718.6cc198c2.js.map