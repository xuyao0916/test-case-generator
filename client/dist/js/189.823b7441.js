"use strict";(self["webpackChunktest_case_generator_client"]=self["webpackChunktest_case_generator_client"]||[]).push([[189],{1189:function(e,l,a){a.r(l),a.d(l,{default:function(){return h}});var t=a(641);const o={class:"format-converter"},n={class:"converter-content"},i={class:"upload-section"},r={key:0,class:"options-section"},d={key:1,class:"action-section"},c={key:2,class:"result-section"},s={class:"result-actions"},u=["innerHTML"];function p(e,l,a,p,m,v){const k=(0,t.g2)("upload-filled"),f=(0,t.g2)("el-icon"),b=(0,t.g2)("el-upload"),g=(0,t.g2)("el-input"),F=(0,t.g2)("el-form-item"),h=(0,t.g2)("el-form"),_=(0,t.g2)("Magic"),w=(0,t.g2)("el-button"),x=(0,t.g2)("RefreshLeft"),C=(0,t.g2)("el-alert"),L=(0,t.g2)("Download"),R=(0,t.g2)("ViewIcon"),y=(0,t.g2)("el-dialog"),V=(0,t.g2)("el-card");return(0,t.uX)(),(0,t.CE)("div",o,[(0,t.bF)(V,{class:"page-card"},{header:(0,t.k6)(()=>l[4]||(l[4]=[(0,t.Lk)("div",{class:"card-header"},[(0,t.Lk)("h2",null,"用例格式转换"),(0,t.Lk)("p",null,"支持上传Excel、XMind等格式文件，自动转换为标准XMind测试用例格式")],-1)])),default:(0,t.k6)(()=>[(0,t.Lk)("div",n,[(0,t.Lk)("div",i,[l[7]||(l[7]=(0,t.Lk)("h3",{class:"section-title"},"文件上传",-1)),(0,t.bF)(b,{ref:"uploadRef",class:"upload-dragger",drag:"","auto-upload":!1,"on-change":p.handleFileChange,"before-upload":p.beforeUpload,accept:".xlsx,.xls,.xmind,.txt,.md,.json,.xml,.csv",limit:1,"on-exceed":p.handleExceed},{tip:(0,t.k6)(()=>l[5]||(l[5]=[(0,t.Lk)("div",{class:"el-upload__tip"}," 支持格式：Excel(.xlsx/.xls)、XMind(.xmind)、文本(.txt/.md)、JSON(.json)、XML(.xml)、CSV(.csv) ",-1)])),default:(0,t.k6)(()=>[(0,t.bF)(f,{class:"el-icon--upload"},{default:(0,t.k6)(()=>[(0,t.bF)(k)]),_:1}),l[6]||(l[6]=(0,t.Lk)("div",{class:"el-upload__text"},[(0,t.eW)(" 将文件拖到此处，或"),(0,t.Lk)("em",null,"点击上传")],-1))]),_:1,__:[6]},8,["on-change","before-upload","on-exceed"])]),p.uploadedFile?((0,t.uX)(),(0,t.CE)("div",r,[l[8]||(l[8]=(0,t.Lk)("h3",{class:"section-title"},"转换选项",-1)),(0,t.bF)(h,{model:p.convertForm,"label-width":"120px"},{default:(0,t.k6)(()=>[(0,t.bF)(F,{label:"文件名称"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:p.convertForm.fileName,"onUpdate:modelValue":l[0]||(l[0]=e=>p.convertForm.fileName=e),placeholder:"请输入转换后的文件名称"},null,8,["modelValue"])]),_:1}),(0,t.bF)(F,{label:"转换说明"},{default:(0,t.k6)(()=>[(0,t.bF)(g,{modelValue:p.convertForm.description,"onUpdate:modelValue":l[1]||(l[1]=e=>p.convertForm.description=e),type:"textarea",rows:3,placeholder:"请描述文件内容或转换要求（可选）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])])):(0,t.Q3)("",!0),p.uploadedFile?((0,t.uX)(),(0,t.CE)("div",d,[(0,t.bF)(w,{type:"primary",onClick:p.convertFile,loading:p.converting,size:"large"},{default:(0,t.k6)(()=>[(0,t.bF)(f,null,{default:(0,t.k6)(()=>[(0,t.bF)(_)]),_:1}),l[9]||(l[9]=(0,t.eW)(" 开始转换 ",-1))]),_:1,__:[9]},8,["onClick","loading"]),(0,t.bF)(w,{onClick:p.clearFile,size:"large"},{default:(0,t.k6)(()=>[(0,t.bF)(f,null,{default:(0,t.k6)(()=>[(0,t.bF)(x)]),_:1}),l[10]||(l[10]=(0,t.eW)(" 重新上传 ",-1))]),_:1,__:[10]},8,["onClick"])])):(0,t.Q3)("",!0),p.convertResult?((0,t.uX)(),(0,t.CE)("div",c,[l[13]||(l[13]=(0,t.Lk)("h3",{class:"section-title"},"转换结果",-1)),(0,t.bF)(C,{title:"转换成功！",type:"success",description:`文件已成功转换为XMind格式，共解析出 ${p.testCaseCount} 个测试用例`,"show-icon":"",closable:!1},null,8,["description"]),(0,t.Lk)("div",s,[(0,t.bF)(w,{type:"success",onClick:p.downloadResult,size:"large"},{default:(0,t.k6)(()=>[(0,t.bF)(f,null,{default:(0,t.k6)(()=>[(0,t.bF)(L)]),_:1}),l[11]||(l[11]=(0,t.eW)(" 下载XMind文件 ",-1))]),_:1,__:[11]},8,["onClick"]),(0,t.bF)(w,{onClick:p.previewResult,size:"large"},{default:(0,t.k6)(()=>[(0,t.bF)(f,null,{default:(0,t.k6)(()=>[(0,t.bF)(R)]),_:1}),l[12]||(l[12]=(0,t.eW)(" 预览内容 ",-1))]),_:1,__:[12]},8,["onClick"])])])):(0,t.Q3)("",!0),(0,t.bF)(y,{modelValue:p.previewVisible,"onUpdate:modelValue":l[3]||(l[3]=e=>p.previewVisible=e),title:"转换预览",width:"80%",top:"5vh"},{footer:(0,t.k6)(()=>[(0,t.bF)(w,{onClick:l[2]||(l[2]=e=>p.previewVisible=!1)},{default:(0,t.k6)(()=>l[14]||(l[14]=[(0,t.eW)("关闭",-1)])),_:1,__:[14]}),(0,t.bF)(w,{type:"primary",onClick:p.downloadResult},{default:(0,t.k6)(()=>[(0,t.bF)(f,null,{default:(0,t.k6)(()=>[(0,t.bF)(L)]),_:1}),l[15]||(l[15]=(0,t.eW)(" 下载文件 ",-1))]),_:1,__:[15]},8,["onClick"])]),default:(0,t.k6)(()=>[(0,t.Lk)("div",{class:"preview-content",innerHTML:p.previewHtml},null,8,u)]),_:1},8,["modelValue"])])]),_:1})])}var m=a(953),v=a(163),k=a(8548),f=a(4335),b={name:"FormatConverter",components:{UploadFilled:k.UploadFilled,Magic:k.Magic,RefreshLeft:k.RefreshLeft,Download:k.Download,ViewIcon:k.View},setup(){const e=(0,m.KR)(),l=(0,m.KR)(null),a=(0,m.KR)(!1),t=(0,m.KR)(""),o=(0,m.KR)(0),n=(0,m.KR)(!1),i=(0,m.KR)(""),r=(0,m.KR)(""),d=(0,m.Kh)({fileName:"",description:""}),c=e=>{l.value=e,d.fileName=e.name.replace(/\.[^/.]+$/,"")+"-converted",v.nk.success("文件上传成功，请设置转换选项")},s=e=>{const l=["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","application/vnd.xmind.workbook","text/plain","text/markdown","application/json","application/xml","text/xml","text/csv"],a=l.includes(e.type)||e.name.toLowerCase().endsWith(".xmind")||e.name.toLowerCase().endsWith(".md");if(!a)return v.nk.error("不支持的文件格式！"),!1;const t=e.size/1024/1024<10;return!!t||(v.nk.error("文件大小不能超过 10MB!"),!1)},u=()=>{v.nk.warning("只能上传一个文件，请先删除已上传的文件")},p=()=>{e.value.clearFiles(),l.value=null,t.value="",d.fileName="",d.description="",r.value="",o.value=0},k=async()=>{if(l.value)if(d.fileName.trim()){a.value=!0;try{const e=new FormData;e.append("file",l.value.raw),e.append("fileName",d.fileName),e.append("description",d.description);const a=await f.A.post("/api/convert-format",e,{headers:{"Content-Type":"multipart/form-data"},timeout:12e4});if(a.data.success){t.value=a.data.content;const e=a.data.content.match(/TC-\d+/g);o.value=e?e.length:0,r.value=a.data.downloadUrl,v.nk.success("文件转换成功！")}else v.nk.error(a.data.error||"转换失败")}catch(e){console.error("转换失败:",e),v.nk.error("转换失败，请稍后重试")}finally{a.value=!1}}else v.nk.error("请输入文件名称");else v.nk.error("请先上传文件")},b=()=>{t.value?(i.value=t.value.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>"),n.value=!0):v.nk.error("没有可预览的内容")},g=()=>{if(!r.value)return void v.nk.error("没有可下载的文件");const e=document.createElement("a");e.href=r.value,e.download="",document.body.appendChild(e),e.click(),document.body.removeChild(e),v.nk.success("文件下载成功")};return{uploadRef:e,uploadedFile:l,converting:a,convertResult:t,testCaseCount:o,previewVisible:n,previewHtml:i,downloadUrl:r,convertForm:d,handleFileChange:c,beforeUpload:s,handleExceed:u,clearFile:p,convertFile:k,previewResult:b,downloadResult:g}}},g=a(6262);const F=(0,g.A)(b,[["render",p],["__scopeId","data-v-f3c422be"]]);var h=F}}]);
//# sourceMappingURL=189.823b7441.js.map